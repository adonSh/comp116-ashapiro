COMP116 Lab 10 -- Malware Analysis
==================================

1. VirusTotal detection ratio: 40/62
2. Permissions: INTERNET, WAKE\_LOCK, READ\_SMS, RECEIVE\_SMS,
	READ\_EXTERNAL\_STORAGE, WRITE\_EXTERNAL\_STORAGE, READ\_PHONE\_STATE,
	SEND\_SMS, RECEIVE\_BOOT\_COMPLETED, READ\_CONTACTS,
	ACCESS\_FINE\_LOCATION, ACCESS\_MOCK\_LOCATION,
	ACCESS\_LOCATION\_EXTRA\_COMMANDS, BIND\_DEVICE\_ADMIN,
	GET\_TASKS, ACCESS\_NETWORK\_STATE

	Without knowing more about what the app is or does, the ability to read
	and receive SMS messages seems a little suspect as does the access to
	external storage and location. "BIND\_DEVICE\_ADMIN" potentially gives
	the app admin permissions and doesn't seem necessary either.
3. Actions are triggered both when the phone sends an SMS message and when the
	phone boots. The Java packages involved are
	".sms.SentReceiver" and "org.merry.core.RunService"
4. There's a suspicious javascript file in res/raw (bootscriptnet.js) which
	seems to be communicating with an external source.
5. res/raw/bootscriptnet has the following phone numbers:
	* 1-910-502-0599
	* 4-879-944-9133
6. Actions of interest:
	* SentReceiver pulls the number and text from the sent message and
		calls the "localScriptLoader" class.
	* OnBootHandler starts the RunService class
7. URLS:
	* http://23.227.163.110/locker.php -- 2/66 VirusTotal detection ratio
	* http://192.227.137.154/request.php -- 2/66 VirusTotal detection ratio
	* http://www.w3.org/2000/xmlns/ -- 0/64 VirusTotal detection ratio
	* http://81.94.205.226 -- 1/65 VirusTotal detected ratio
8. At the very least, the app seems to intercept SMS messages and communicate
	with an external server. It also has suspicious classes like "BankApp"
	and numerous permissions allowing the app almost total access to the
	phone. It's most likely stealing personal information from the phone
	any way it can; e.g. text messages, phishing with a fake bank app,
	admin permissions, etc.
	
	Evidence
	--------
	* Intercepting SMS: smali/org/merry/core/sms/SentReceiver.smali - lines
		36, 44, 46
	* External Communication: smali/org/merry/core/RunService.smali - line
		1017, 1437, smali/org/merry/core/Constants.smali - line 137
	* Phishing: smali/merry/core/activities/BankApp.smali

	--Adon Shapiro
